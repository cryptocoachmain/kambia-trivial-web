<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Kambia Trivial Leioa</title>
    <link rel="stylesheet" href="css/styles.css">
    <link rel="icon" type="image/png" href="assets/Logo-kambia_WEB.png">
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <!-- Material Icons -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
</head>

<body>

    <!-- VIDEO OVERLAY CONTAINER -->
    <div id="video-overlay" class="video-overlay hidden">
        <video id="game-video" playsinline webkit-playsinline></video>
        <button id="skip-video-btn" class="hidden">Saltar</button>
    </div>

    <!-- APP CONTAINER -->
    <div id="app-container">

        <!-- LOGIN SCREEN -->
        <section id="login-screen" class="screen active">
            <div class="scroll-content">
                <img src="assets/Logo-kambia_WEB.png" alt="Kambia Logo" class="logo">
                <h1>Bienvenido al Trivial de Kambia</h1>

                <div class="input-group">
                    <label for="phone-input">Número de teléfono</label>
                    <input type="tel" id="phone-input" placeholder="Introduce tu número" maxlength="9">
                    <span class="helper-text">Introduce los 9 dígitos sin espacios</span>
                </div>

                <h2>Selecciona tu equipo:</h2>
                <div class="team-selector" id="team-selector">
                    <!-- Teams will be injected here by JS -->
                </div>
                <p id="team-error" class="error-text hidden">Por favor, selecciona un equipo</p>

                <button id="login-btn" class="btn primary" disabled>CONTINUAR</button>
            </div>
        </section>

        <!-- WELCOME SCREEN (Post Login) -->
        <section id="welcome-screen" class="screen hidden">
            <div class="scroll-content">
                <img src="assets/Logo-kambia_WEB.png" alt="Kambia Logo" class="logo">

                <div class="card">
                    <p class="highlight-text">Esta aplicación se ha desarrollado para la Fundación Kambia.</p>
                    <div class="bizum-box">
                        <p>Si desea hacer su donativo, nuestro código de Bizum es el</p>
                        <p class="bizum-code">02147</p>
                    </div>
                    <p class="small-text">(donar, fundaciones, organizaciones sin ánimo de lucro...)</p>
                </div>

                <button id="start-app-btn" class="btn primary">EMPEZAR</button>

                <div class="sponsored-box">
                    <p class="label">PATROCINADO POR</p>
                    <p class="content">Aquí su Publicidad</p>
                </div>
            </div>
        </section>

        <!-- HOME SCREEN -->
        <section id="home-screen" class="screen hidden">
            <div class="scroll-content">
                <img src="assets/Logo-kambia_WEB.png" alt="Kambia Logo" class="logo-small">

                <!-- Admin Messages -->
                <div class="card primary-card" id="admin-messages-card">
                    <div class="card-header">
                        <span class="material-icons">info</span>
                        <span>MENSAJES DEL ADMINISTRADOR</span>
                    </div>
                    <div class="message-content">
                        <button id="prev-msg-btn" class="icon-btn"><span
                                class="material-icons">arrow_back</span></button>
                        <div class="message-text-container">
                            <p id="admin-message-text">Cargando mensajes...</p>
                            <span id="message-counter">0 / 0</span>
                        </div>
                        <button id="next-msg-btn" class="icon-btn"><span
                                class="material-icons">arrow_forward</span></button>
                    </div>
                </div>

                <button id="show-android-install-btn" class="btn primary"
                    style="background-color: #4CAF50; margin-bottom: 2rem; margin-top: 1rem;">
                    <span class="material-icons" style="vertical-align: middle; margin-right: 5px;">android</span>
                    DESCARGAR APP PARA ANDROID
                </button>

                <!-- Presencial Scores -->
                <div class="card">
                    <h3>SPORTS LEIOA PRESENCIALES</h3>
                    <div id="presencial-ranking-list">
                        <!-- Injected by JS -->
                        <div class="ranking-row"><span class="red">1. Loyola</span><span>0 pts</span></div>
                        <div class="ranking-row"><span class="yellow">2. Javier</span><span>0 pts</span></div>
                        <div class="ranking-row"><span class="blue">3. Avila</span><span>0 pts</span></div>
                    </div>
                </div>

                <h3>SPORTS LEIOA ONLINE</h3>

                <!-- Current Team Badge -->
                <div class="card team-badge-card" id="my-team-card">
                    <!-- Injected by JS -->
                </div>

                <!-- Online Scoreboard -->
                <div class="card">
                    <img src="assets/maryward_header.png" alt="Mary Ward" class="card-image" id="mary-ward-img">
                    <h3>CLASIFICACIÓN TOTAL</h3>
                    <div id="global-ranking-list">
                        <!-- Injected by JS -->
                    </div>

                    <div class="divider"></div>

                    <h3>TU PUNTUACIÓN PERSONAL</h3>
                    <div id="user-scores-list">
                        <!-- Injected by JS -->
                    </div>
                </div>

                <!-- Plenums Ranking -->
                <div class="card" id="plenums-ranking-card">
                    <h3>CLASIFICACIÓN POR PLENOS 10/10</h3>
                    <table class="ranking-table">
                        <thead>
                            <tr>
                                <th>Jugador</th>
                                <th>Plenos</th>
                            </tr>
                        </thead>
                        <tbody id="plenums-ranking-body">
                            <!-- Injected by JS -->
                        </tbody>
                    </table>
                </div>

                <!-- Games Played Ranking -->
                <div class="card" id="games-ranking-card">
                    <h3>CLASIFICACIÓN POR PARTIDAS JUGADAS</h3>
                    <table class="ranking-table">
                        <thead>
                            <tr>
                                <th>Jugador</th>
                                <th>Partidas</th>
                            </tr>
                        </thead>
                        <tbody id="games-ranking-body">
                            <!-- Injected by JS -->
                        </tbody>
                    </table>
                </div>

                <!-- Player Ranking -->
                <div class="card" id="player-ranking-card">
                    <h3>CLASIFICACIÓN POR JUGADOR</h3>
                    <table class="ranking-table">
                        <thead>
                            <tr>
                                <th>Pos</th>
                                <th>Teléfono</th>
                                <th class="red">Loy</th>
                                <th class="yellow">Jav</th>
                                <th class="blue">Avi</th>
                                <th>Tot</th>
                            </tr>
                        </thead>
                        <tbody id="player-ranking-body">
                            <!-- Injected by JS -->
                        </tbody>
                    </table>
                    <button id="view-full-ranking-btn" class="btn secondary"
                        style="margin-top: 1rem; font-size: 0.9rem;">Ver Clasificación Completa</button>
                </div>

                <!-- Sponsored By -->
                <div class="sponsored-box">
                    <p class="label">PATROCINADO POR</p>
                    <p class="content">Aquí su Publicidad</p>
                </div>

                <button id="play-game-btn" class="btn primary">JUGAR AL TRIVIAL</button>

                <div class="card transparent">
                    <h4>Cómo funciona:</h4>
                    <ul>
                        <li>10 preguntas sobre la historia de Mary Ward</li>
                        <li>10 puntos por respuesta correcta</li>
                        <li>50 puntos extra por pleno (10/10)</li>
                        <li>Las respuestas se mezclan en cada ronda</li>
                        <li style="color: red; font-weight: bold; text-transform: uppercase;">DURANTE EL JUEGO, NO
                            ABANDONE LA PANTALLA DE PREGUNTAS O SERÁ EXPULSADO DE LA PARTIDA</li>
                    </ul>
                </div>

                <button id="report-issue-btn" class="btn danger">Enviar Incidencia al Administrador</button>

                <!-- Footer Links -->
                <div class="footer-links">
                    <h4>Enlaces Fundación Kambia</h4>
                    <div class="link-icons">
                        <a href="tel:+34916252181" class="circle-icon"><span class="material-icons">phone</span></a>
                        <a href="mailto:hola@fundacionkambia.org" class="circle-icon"><span
                                class="material-icons">email</span></a>
                        <a href="https://www.instagram.com/fundacionkambia/" target="_blank" class="circle-icon"><span
                                class="material-icons">camera_alt</span></a>
                        <a href="https://www.youtube.com/channel/UCzSCv7f8QSQBF_r5dNwicjg" target="_blank"
                            class="circle-icon"><span class="material-icons">play_arrow</span></a>
                        <a href="https://www.linkedin.com/company/fundacionkambia" target="_blank"
                            class="circle-icon"><span class="material-icons">business</span></a>
                    </div>
                </div>
            </div>
        </section>

        <!-- GAME SCREEN -->
        <section id="game-screen" class="screen hidden">
            <div class="game-header">
                <div class="question-info">
                    <span style="font-weight: bold; color: var(--kambia-green); font-size: 1.1rem;">
                        Pregunta <span id="current-question-num">1</span>/10
                    </span>
                </div>
                <div class="timer-bar">
                    <div id="timer-progress" class="timer-progress"></div>
                </div>
            </div>

            <div class="scroll-content game-content">
                <div class="question-card">
                    <p id="question-text">Cargando pregunta...</p>
                </div>

                <div id="options-container" class="options-grid">
                    <button class="option-btn" data-opt="a"></button>
                    <button class="option-btn" data-opt="b"></button>
                    <button class="option-btn" data-opt="c"></button>
                    <button class="option-btn" data-opt="d"></button>
                </div>

                <div id="feedback-msg" class="feedback-msg hidden"></div>
            </div>

            <!-- Anti Cheat Warning -->
            <div id="cheat-warning" class="modal hidden">
                <div class="modal-content warning">
                    <span class="material-icons">warning</span>
                    <p id="cheat-msg">¡CUIDADO! NO SALGAS DE LA APP</p>
                </div>
            </div>
        </section>

        <!-- FULL RANKING SCREEN -->
        <section id="full-ranking-screen" class="screen hidden">
            <div class="scroll-content">
                <div class="card-header" style="color: var(--kambia-green);">
                    <span class="material-icons">leaderboard</span>
                    <span>CLASIFICACIÓN COMPLETA</span>
                </div>

                <div class="card" id="full-ranking-card">
                    <table class="ranking-table">
                        <thead>
                            <tr>
                                <th>Pos</th>
                                <th>Teléfono</th>
                                <th class="red">Loy</th>
                                <th class="yellow">Jav</th>
                                <th class="blue">Avi</th>
                                <th>Tot</th>
                            </tr>
                        </thead>
                        <tbody id="full-ranking-body">
                            <!-- Injected by JS -->
                        </tbody>
                    </table>
                </div>

                <button id="close-full-ranking-btn" class="btn primary">VOLVER AL MENÚ</button>
            </div>
        </section>

        <!-- THANKS SCREEN -->
        <section id="thanks-screen" class="screen hidden">
            <div class="scroll-content centered">
                <img src="assets/Logo-kambia_WEB.png" alt="Kambia Logo" class="logo">
                <h2>¡Partida Terminada!</h2>

                <div class="card result-card">
                    <h3>Puntuación Final</h3>
                    <p class="big-score" id="final-score">0</p>
                    <p>Aciertos: <span id="final-correct">0</span>/10</p>
                    <p id="perfect-bonus-msg" class="hidden positive">+50 Bono Pleno</p>
                </div>

                <div class="card">
                    <p>El desarrollo de este proyecto ha sido un gran desafío y una enorme inversión de tiempo y
                        esfuerzo.</p>
                    <p>A cambio, solo te pedimos tu colaboración. Todo lo recaudado va dirigido a financiar nuestros
                        proyectos solidarios.</p>
                    <p class="bizum-code" style="margin-top: 1rem;">Bizum: 02147</p>
                </div>

                <button id="back-home-btn" class="btn primary">VOLVER AL MENU</button>
            </div>
        </section>

        <!-- ANDROID INSTALL SCREEN -->
        <section id="android-install-screen" class="screen hidden">
            <div class="scroll-content centered">
                <div class="card-header" style="color: #4CAF50; margin-bottom: 1rem;">
                    <span class="material-icons" style="font-size: 3rem;">android</span>
                </div>
                <h2 style="color: #4CAF50; margin-bottom: 1rem;">Instalar App Android</h2>

                <div class="card" style="text-align: left;">
                    <p style="margin-bottom: 1rem;">Esta aplicación ha sido desarrollada por la <strong>Fundación
                            Kambia</strong> y es totalmente segura.</p>
                    <p style="margin-bottom: 1rem;">Al no estar todavía en Play Store (estamos en ello), tu dispositivo
                        podría bloquear la instalación por defecto.</p>
                    <p><strong>Para instalarla:</strong></p>
                    <ol style="margin: 0.5rem 0 0.5rem 1.5rem; line-height: 1.6;">
                        <li>Pulsa el botón verde "Descargar e Instalar".</li>
                        <li>Cuando termine la descarga (puede tardar unos segundos), pulsa "Abrir" en la notificación.
                        </li>
                        <li>Si te pide permiso, activa <strong>"Instalar aplicaciones desconocidas"</strong> o "Confiar
                            en esta fuente".</li>
                        <li>Pulsa "Instalar".</li>
                    </ol>
                </div>

                <a href="kambia-leioa-trivial.apk" download class="btn primary"
                    style="background-color: #4CAF50; margin-bottom: 1rem; text-decoration: none; display: flex; justify-content: center; align-items: center; color: white; font-weight: bold;">
                    DESCARGAR E INSTALAR
                </a>

                <button id="android-cancel-btn" class="btn secondary"
                    style="border-color: #4CAF50; color: #4CAF50;">VOLVER SIN INSTALAR APP ANDROID</button>
            </div>
        </section>

    </div>

    <!-- SCRIPTS -->
    <script src="js/questions.js"></script>
    <script src="js/video-player.js"></script>
    <script src="js/api.js"></script>
    <script src="js/app.js"></script>
</body>

</html>